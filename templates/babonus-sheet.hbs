<form>

  <div class="header name-stacked">
    <img src="{{bonus.img}}" data-edit="img" alt="{{bonu.name}}">
    <input class="title" type="text" name="name" value="{{bonus.name}}" placeholder="{{localize 'Name'}}">
  </div>

  <nav class="tabs" data-group="main">
    <a class="item" data-tab="description">{{localize "BABONUS.SheetTabs.Description"}}</a>
    <a class="item" data-tab="bonuses">{{localize "BABONUS.SheetTabs.Bonuses"}}</a>
    <a class="item" data-tab="configuration">{{localize "BABONUS.SheetTabs.Configuration"}}</a>
    <a class="item" data-tab="filters">{{localize "BABONUS.SheetTabs.Filters"}}</a>
    <a class="item" data-tab="advanced">{{localize "BABONUS.SheetTabs.Advanced"}}</a>
  </nav>

  <div class="document-tabs">

    <!-- Description Tab -->
    <div class="tab" data-tab="description">
      <div class="description">
        <ol class="properties">
          <h4 class="header">{{localize "DND5E.Properties"}}</h4>
          {{#each context.labels}}
          <li class="property">{{this}}</li>
          {{/each}}
        </ol>
        {{editor context.description target="description" button=true engine="prosemirror" collaborate=false}}
      </div>
    </div>

    <!-- Bonuses Tab -->
    <div class="tab" data-tab="bonuses">

      <fieldset>
        <legend>{{localize "BABONUS.BasicBonuses"}}</legend>
        {{#each context.bonuses}}
        {{#if isDamage}}
        {{formGroup field value=value options=options blank=blank localize=true}}
        {{else}}
        {{formGroup field value=value localize=true}}
        {{/if}}
        {{/each}}
      </fieldset>

      {{#if context.hasModifiers}}
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Config.Label"}}</legend>

        {{formGroup context.modifiers.config.first.field value=context.modifiers.config.first.value localize=true}}

        <div class="form-group modifiers example">
          <label class="label">{{localize "BABONUS.Example"}}:</label>
          <div class="form-fields formula">{{context.modifiers.config.example}}</div>
        </div>
      </fieldset>

      <!-- Amount -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Amount.Label"}}</legend>
        {{#with context.modifiers.amount}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{formGroup mode.field value=mode.value localize=true}}
        {{/if}}
        {{/with}}
      </fieldset>

      <!-- Size -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Size.Label"}}</legend>
        {{#with context.modifiers.size}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{formGroup mode.field value=mode.value localize=true}}
        {{/if}}
        {{/with}}
      </fieldset>

      <!-- Reroll -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Reroll.Label"}}</legend>
        {{#with context.modifiers.reroll}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{formGroup invert.field value=invert.value localize=true}}
        {{formGroup recursive.field value=recursive.value localize=true}}
        {{#if recursive.value}}
        {{formGroup limit.field value=limit.value localize=true placeholder=(localize limit.field.label)}}
        {{/if}}
        {{/if}}
        {{/with}}
      </fieldset>

      <!-- Explode -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Explode.Label"}}</legend>
        {{#with context.modifiers.explode}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{formGroup once.field value=once.value localize=true}}
        {{#unless once.value}}
        {{formGroup limit.field value=limit.value localize=true placeholder=(localize limit.field.label)}}
        {{/unless}}
        {{/if}}
        {{/with}}
      </fieldset>

      <!-- Minimum -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Minimum.Label"}}</legend>
        {{#with context.modifiers.minimum}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup maximize.field value=maximize.value localize=true}}
        {{#unless maximize.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{/unless}}
        {{/if}}
        {{/with}}
      </fieldset>

      <!-- Maximum -->
      <fieldset>
        <legend>{{localize "BABONUS.Modifiers.Maximum.Label"}}</legend>
        {{#with context.modifiers.maximum}}
        {{formGroup enabled.field value=enabled.value localize=true}}
        {{#if enabled.value}}
        {{formGroup value.field value=value.value localize=true placeholder=(localize value.field.label)}}
        {{formGroup zero.field value=zero.value localize=true}}
        {{/if}}
        {{/with}}
      </fieldset>

      {{/if}}

    </div>

    <!-- Active Filters Tab -->
    <div class="tab" data-tab="configuration">
      {{#unless context.filters}}
      <p class="notification info">{{localize "BABONUS.CurrentFiltersTooltip"}}</p>
      {{/unless}}
      {{{context.filters}}}
    </div>

    <!-- Filter Picker Tab -->
    <div class="tab" data-tab="filters">
      <p class="notification info">{{localize "BABONUS.AvailableFiltersTooltip"}}</p>
      {{#each context.filterpickers}}
      <div class="filter">
        <a class="filter-header" data-action="add-filter" data-id="{{id}}">
          {{localize label}} {{#if repeats}}({{repeats}}){{/if}}
          <i class="fa-solid fa-plus"></i>
        </a>
        <div class="filter-description">{{{localize hint}}}</div>
      </div>
      {{/each}}
    </div>

    <!-- Config Tab -->
    <div class="tab" data-tab="advanced">

      <fieldset>
        <legend>{{localize "BABONUS.Toggles"}}</legend>
        {{formGroup context.root.enabled.field value=context.root.enabled.value localize=true}}
        {{formGroup context.root.exclusive.field value=context.root.exclusive.value localize=true}}
        {{formGroup context.root.optional.field value=context.root.optional.value localize=true}}
        {{formGroup context.root.reminder.field value=context.root.reminder.value localize=true disabled=context.root.reminder.disabled}}
      </fieldset>

      <fieldset>
        <legend>{{localize "BABONUS.Fields.Consume.Label"}}</legend>
        {{formGroup context.consume.enabled.field value=context.consume.enabled.value localize=true}}
        {{#if bonus.consume.enabled}}
        {{formGroup context.consume.type.field value=bonus.consume.type localize=true sort=true blank="-"}}
        {{#unless context.consume.scale.unavailable}}
        {{#if context.consume.subtype.show}}
        {{formGroup context.consume.subtype.field value=bonus.consume.subtype localize=true sort=false blank="-" choices=context.consume.subtype.choices label=context.consume.subtype.label}}
        {{/if}}
        {{#unless context.consume.scale.unavailable}}
        {{formGroup context.consume.scale.field localize=true value=bonus.consume.scales}}
        {{/unless}}

        <div class="form-group values">
          <label>
            {{localize context.consume.values.label}}
            {{{context.consume.values.range}}}
          </label>
          <div class="form-fields">
            {{formInput context.consume.values.field1 value=context.consume.source.value.min placeholder=context.consume.values.ph1}}
            {{#if bonus.consume.scales}}
            <span class="sep dash">&mdash;</span>
            {{formInput context.consume.values.field2 value=context.consume.source.value.max placeholder=context.consume.values.ph2}}
            {{/if}}
          </div>
          <p class="hint">{{localize context.consume.values.hint}}</p>
        </div>

        {{#if context.consume.step.show}}
        {{formGroup context.consume.step.field value=bonus.consume.value.step localize=true placeholder=(localize context.consume.step.field.label)}}
        {{/if}}

        {{#if context.consume.formula.show}}
        {{formGroup context.consume.formula.field value=bonus.consume.formula localize=true placeholder=context.consume.formula.placeholder}}
        {{/if}}

        {{/unless}}

        {{/if}}

      </fieldset>

      <fieldset>
        <legend>{{localize "BABONUS.Fields.Aura.Label"}}</legend>
        {{formGroup context.aura.enabled.field value=context.aura.enabled.value localize=true}}

        {{#if bonus.aura.enabled}}
        {{formGroup context.aura.template.field value=context.aura.template.value localize=true}}
        {{#unless context.aura.template.value}}
        {{formGroup context.aura.range.field value=context.aura.range.value localize=true label=context.aura.range.label placeholder=(localize context.aura.range.field.label)}}
        {{/unless}}
        {{formGroup context.aura.disposition.field value=context.aura.disposition.value localize=true sort=false}}
        {{formGroup context.aura.self.field value=context.aura.self.value localize=true}}
        {{formGroup context.aura.blockers.field value=context.aura.blockers.value localize=true}}
        {{#each context.aura.requirements}}
        {{formGroup field value=value localize=true}}
        {{/each}}
        {{/if}}
      </fieldset>

    </div>

  </div>
</form>
